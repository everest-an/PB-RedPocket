1. 新增技术架构：双引擎驱动
在技术实现上，你需要处理 EVM 层的用户体验 (ERC-4337) 与 Polkadot 层的资产流动 (XCM)。

ERC-4337 (入口引擎)： 负责在 Moonbeam 或 Astar 等 EVM 平行链上提供“无感体验”。

Paymaster 合约： 企业预存 Gas 费。当用户通过 WhatsApp/GitHub 链接领取时，Paymaster 支付交易费用，用户 0 Gas 领取。

Bundler 节点： 收集用户的领取意图（UserOperation），批量打包上链。

XCM (结算引擎)： 负责资产在波卡生态内的物理转移。

跨链预编译 (XCM Precompiles)： 在 Moonbeam 上，通过 Solidity 合约直接调用 IXcm.sol 接口。

储备资产转移 (Reserve Asset Transfer)： 将资金从企业的 Asset Hub 地址安全地传送到用户的领取链。

2. 功能文档（FSD）新增项
2.1 跨链红包分发逻辑
企业侧： 支持选择“结算目标链”。例如，企业在 Asset Hub 存入 DOT，但设置红包可在 Moonbeam 上以 xcDOT（跨链 DOT）形式领取。

用户侧： 新增“链自动识别”。用户点击链接，系统自动检测当前社交 ID 绑定的钱包地址在哪条链上最活跃，或者默认分发到 Gas 费最低、兼容性最好的 EVM 平行链。

2.2 自动化财务追溯 (XCM Tracking)
XCM 状态监控： 新增“跨链中 (In-transit)”状态。由于 XCM 跨链有延迟，管理后台需实时显示资金是否已离开源链、是否已到达目标链。

多链资产概览： 个人中心新增一个仪表盘，显示你在 Asset Hub、Moonbeam、Astar 各自领取的红包总额及分布。

3. 开发文档（Project Dev）新增项
3.1 核心合约：ProtocolBankXCMHandler.sol
这是一个部署在波卡 EVM 链上的合约，结合了 AA 验证与 XCM 发送。

Solidity

// 伪代码示例：结合 AA 的 XCM 领取逻辑
function claimCrossChainReward(address recipient, uint256 amount, uint32 destParaId) public {
    // 1. 权限校验（由 Bundler/EntryPoint 触发）
    require(msg.sender == address(entryPoint), "Only EntryPoint");

    // 2. 调用 XCM 预编译接口执行跨链转账
    // 使用 Moonbeam 的 XCM Precompile 地址
    IXcm xcm = IXcm(0x00000000000000000000000000000000000a0000);
    xcm.transfer_reserve_asset(
        destParaId, 
        recipient, 
        amount, 
        weight_limit
    );

    // 3. 记录财务事件供 Backend 抓取
    emit CrossChainRewardClaimed(recipient, amount, destParaId);
}
3.2 身份映射逻辑 (Social-to-Polkadot Address)
SS58 兼容性： 系统需支持将生成的 AA 钱包地址（以太坊格式 0x...）映射到波卡原生地址（SS58 格式）。

账户提取： 用户在 protocolbank.com 提现时，支持一键将 Moonbeam 的 xcDOT 通过 XCM 返回到 Asset Hub 或 Relay Chain 的个人地址。